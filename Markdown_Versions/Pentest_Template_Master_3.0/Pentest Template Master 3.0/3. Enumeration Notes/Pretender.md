# Source: https://github.com/RedTeamPentesting/pretender

# Installation

## In Kali: 
- git clone https://github.com/RedTeamPentesting/pretender
- go build
- pretender --help

## Using Pretender: 
- pretender -i eth0
- pretender -i eth0 --dry (Only logs incoming queries and does not answer any of them)
- pretender -i eth0 --dry --no-ra # without router advertisements

## Options to disabled certain attacks:

--no-dhcp-dns
--no-lnr
--no-mdns
--no-llmnr
--no-netbios
--no-ra

## Tips

- Make sure to enable IPv6 support in `ntlmrelayx.py` with the `-6` flag
- Pretender can be configured to stop after a certain time period for situations
  where it cannot be aborted manually (`--stop-after` and
  `main.vendorStopAfter`)
- Host info lookup (which relies on the ARP table, IP neighbours and reverse
  lookups) can be disabled with `--no-host-info` or `main.vendorNoHostInfo`
- If you are not sure which interface to choose (especially on Windows), list
  all interfaces with names and addresses using `--interfaces`
- If you want to exclude hosts from local name resolution spoofing, make sure to
  also exclude their IPv6 addresses or use
  `--no-ipv6-lnr`/`main.vendorNoIPv6LNR`
- DHCPv6 messages usually contain a FQDN option (which can also sometimes
  contain a hostname which is not a FQDN). This option is used to filter out
  messages by hostname (`--spoof-for`/`--dont-spoof-for`). You can decide what
  to do with DHCPv6 messages without FQDN option by setting or omitting
  `--ignore-nofqdn`
- Depending on the build configuration, either the operating system resolver
  (`CGO_ENABLED=1`) or a Go implementation (`CGO_ENABLED=0`) is used. This can
  be important for host info collection because the OS resolver may support
  local name resolution and the Go implementation does not, unless a stub
  resolver is used.
- The host info functionality is currently only available for Windows and Linux.
- A custom MAC address vendor list can be compiled into the binary by replacing
  the default list `hostinfo/mac-vendors.txt`. Only lines with MAC prefixes in
  the following format are recognized: `FF:FF:FF<tab>VendorID<tab>Vendor` (the
  MAC prefix length can be arbitrary).
- If you only want to perform Kerberos relaying you can specify `--no-lnr` and
  `--spoof-types SOA` to ignore any queries that are unrelated to the attack.
- When conducting a Kerberos relay attack where `krbrelayx.py` runs on a
  different host than pretender (relay IPv4 address points to different host
  that runs `krbrelayx.py`), the host running `krbrelayx.py` will also need to
  run pretender in order to receive and deny the Dynamic Update query sent to
  the relay IPv4 address.
- By default, in order to limit disruption during a DHCPv6 DNS Takeover, the
  option `--delegate-ignored-to <DNS server>` can be used to delegate ignored
  queries to a legitimate DNS server.
- The option `--dry-with-dhcp` can be combined with `--delegate-ignored-to` to
  monitor the name resolution queries in the network without disruption.
---